-- Load Rayfield (working link as of 2026)
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Create the main window
local Window = Rayfield:CreateWindow({
    Name = "HM Hub",
    LoadingTitle = "LOADING HM HUB...",
    LoadingSubtitle = "By Tha Hollows",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "HMhub",
        FileName = "Config"
    },
    KeySystem = false,
})

-- Main tab
local MainTab = Window:CreateTab("Main", 4483362458)

-- Variables
local autoClick = false
local autoStat = false
local selectedStat = "Energy"  -- Default

-- =====================================
-- AUTO CLICKER
-- =====================================
local ClickToggle = MainTab:CreateToggle({
    Name = "Auto Clicker",
    CurrentValue = false,
    Flag = "AutoClickToggle",
    
    Callback = function(Value)
        autoClick = Value
        
        if Value then
            Rayfield:Notify({
                Title = "Auto Clicker",
                Content = "Clicking every ~0.03s...",
                Duration = 3
            })
            
            task.spawn(function()
                while autoClick do
                    pcall(function()
                        local clickRemote = game:GetService("ReplicatedStorage")
                            :WaitForChild("Packages")
                            :WaitForChild("_Index")
                            :WaitForChild("sleitnick_knit@1.5.1")
                            :WaitForChild("knit")
                            :WaitForChild("Services")
                            :WaitForChild("ClickService")
                            :WaitForChild("RF")
                            :WaitForChild("Click")
                        
                        clickRemote:InvokeServer()
                    end)
                    
                    task.wait(0.1)  -- Increase to 0.1 if you get kicked
                end
            end)
        end
    end,
})

task.wait(0.5)
local Tab = Window:CreateTab("Misc", 4483362458) -- Title, Image

Tab:CreateToggle({
    Name = "Auto Rank Up",  -- Changed from "Auto Ascension"
    CurrentValue = false,
    Flag = "AutoRankUp",    -- Updated flag name to match (avoids old config conflict)
    
    Callback = function(Value)
        getgenv().AutoRankUp = Value
        
        if Value then
            Rayfield:Notify({
                Title = "Auto Rank Up",
                Content = "Ranking up every 60s...",
                Duration = 4
            })
            
            task.spawn(function()
                while getgenv().AutoRankUp do
                    local success, err = pcall(function()
                        game:GetService("ReplicatedStorage")
                            :WaitForChild("Packages")
                            :WaitForChild("_Index")
                            :WaitForChild("sleitnick_knit@1.5.1")
                            :WaitForChild("knit")
                            :WaitForChild("Services")
                            :WaitForChild("RankupService")
                            :WaitForChild("RF")
                            :WaitForChild("RankUp")
                            :InvokeServer()
                    end)
                    
                    if not success then
                        warn("Auto Rank Up error: " .. tostring(err))
                        Rayfield:Notify({
                            Title = "Auto Rank Up Error",
                            Content = "Failed to rank up – check console. Stopping...",
                            Duration = 6
                        })
                        getgenv().AutoRankUp = false
                        break
                    end
                    
                    task.wait(60)  -- Safe 60-second delay (adjust if needed)
                end
            end)
        else
            Rayfield:Notify({
                Title = "Auto Rank Up",
                Content = "Stopped.",
                Duration = 3
            })
        end
    end,
})

task.wait(0.5)
local Tab = Window:CreateTab("Auto Quest + Farm", 4483362458) -- Title, Image

-- Paste this inside your Tab (e.g. after creating the Tab)
-- Dropdown shows UNIQUE mob types only (e.g. "Brulo", "Cell", "Frieza" instead of every _1, _2, etc.)

local nomekFolder = workspace:WaitForChild("MobSpawns"):WaitForChild("Nomek")

-- Function to get unique mob base names
local function getUniqueMobTypes()
    local uniqueTypes = {}
    local seen = {}  -- prevent duplicates

    for _, part in ipairs(nomekFolder:GetChildren()) do
        if part:IsA("BasePart") then
            -- Remove common suffixes: _number, (Clone), Clone, etc.
            local baseName = part.Name
                :gsub("_%d+$", "")          -- Brulo_1 → Brulo
                :gsub(" %b()$", "")         -- Brulo (Clone) → Brulo
                :gsub("Clone$", "")         -- BruloClone → Brulo
                :match("^%s*(.-)%s*$")      -- trim spaces

            if baseName and baseName ~= "" and not seen[baseName] then
                seen[baseName] = true
                table.insert(uniqueTypes, baseName)
            end
        end
    end

    table.sort(uniqueTypes)
    
    if #uniqueTypes == 0 then
        table.insert(uniqueTypes, "No mob types found in Nomek")
    end
    
    return uniqueTypes
end

-- Create the dropdown with unique types
local MobTypeDropdown = Tab:CreateDropdown({
    Name = "Nomek Mob Types",
    Options = getUniqueMobTypes(),
    CurrentOption = {},
    MultipleOptions = false,
    Flag = "NomekMobTypeSelect",
    
    Callback = function(Option)
        local selectedType = Option[1]  -- Rayfield passes {selected_value}
        
        if selectedType and selectedType ~= "No mob types found in Nomek" then
            Rayfield:Notify({
                Title = "Mob Type Selected",
                Content = "Targeting all: " .. selectedType,
                Duration = 3
            })
            print("Selected mob type:", selectedType)
            
            -- Optional: Example action - print how many spawns of this type exist
            local count = 0
            for _, part in ipairs(nomekFolder:GetChildren()) do
                if part:IsA("BasePart") and part.Name:match("^" .. selectedType .. "(_%d+)?$") then
                    count = count + 1
                end
            end
            print("Found " .. count .. " spawns of " .. selectedType)
            
            -- You can add teleport, highlight, etc. here later
        end
    end,
})

-- Refresh button to update if new mob types appear
Tab:CreateButton({
    Name = "Refresh Mob Types",
    Callback = function()
        local newOptions = getUniqueMobTypes()
        MobTypeDropdown:Refresh(newOptions, true)  -- true = clear old list first
        Rayfield:Notify({
            Title = "Mob Types Refreshed",
            Content = #newOptions .. " unique types found in Nomek",
            Duration = 3
        })
    end,
})
