local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Rayfield Example Window",
   Icon = 0,
   LoadingTitle = "Rayfield Interface Suite",
   LoadingSubtitle = "by Sirius",
   ShowText = "Rayfield",
   Theme = "Default",

   ToggleUIKeybind = "K",

   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false,

   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "Big Hub"
   },

   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },

   KeySystem = false,
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided",
      FileName = "Key",
      SaveKey = true,
      GrabKeyFromSite = false,
      Key = {"Hello"}
   }
})

local Tab = Window:CreateTab("Tab Example", 4483362458) -- Title, Image

local autoThrow = false

local Toggle = Tab:CreateToggle({
   Name = "AutoThrow",
   CurrentValue = false,
   Flag = "AutoThrowToggle",
   
   Callback = function(Value)
      autoThrow = Value   -- sync with the actual toggle state (true/false)

      if Value then
         -- Run the loop in a separate thread so it doesn't freeze the game
         task.spawn(function()
            while autoThrow do
               local args = {
                  "City"
               }
               
               -- Safe remote firing with timeout + error protection
               pcall(function()
                  game:GetService("ReplicatedStorage")
                     :WaitForChild("Remotes", 8)
                     :WaitForChild("Throw", 5)
                     :FireServer(unpack(args))
               end)
               
               task.wait(0.08)   -- ‚âà 12 throws/sec ‚Äî adjust this:
                                 -- 0.05 = faster   /   0.15 = slower & safer
            end
         end)
      end
      -- When toggle turned OFF ‚Üí autoThrow = false ‚Üí loop stops automatically
   end,
})

-- Add this after your Tab is created

-- IMPROVED Target Detector ‚Äî Now with DEBUG PRINTS & Broader Scan!
-- Paste this after your Tab is created. Check CONSOLE (F9) for "Found X targets: name1, name2..."

local selectedTarget = "Bullseye Elite"  -- fallback

local TargetDropdown = Tab:CreateDropdown({
   Name = "Select Training Target",
   Options = {"Scanning..."},  
   CurrentOption = {"Bullseye Elite"},  
   Flag = "SelectedTargetDropdown",
   
   Callback = function(Option)
      selectedTarget = Option[1]
      Rayfield:Notify({
         Title = "Target Set",
         Content = "Training on: " .. selectedTarget,
         Duration = 2,
      })
   end,
})

-- BETTER refresh function with DEBUG & broader detection
local function refreshTargets()
   print("üîç [DEBUG] Scanning workspace for targets...")
   local targetsList = {}
   local seen = {}
   
   -- More possible folders (added common ones for spear games)
   local possibleFolders = {
      workspace:FindFirstChild("TrainingArea"),
      workspace:FindFirstChild("Targets"),
      workspace:FindFirstChild("Bullseye"),
      workspace:FindFirstChild("Bullseyes"),
      workspace:FindFirstChild("Training"),
      workspace:FindFirstChild("Map"),
      workspace:FindFirstChild("Arena"),
      workspace:FindFirstChild("Areas"),
      workspace,  -- FULL scan fallback
   }
   
   local totalScanned = 0
   for _, folder in ipairs(possibleFolders) do
      if folder then
         for _, obj in ipairs(folder:GetDescendants()) do
            totalScanned += 1
            if (obj:IsA("BasePart") or obj:IsA("Model")) and obj.Name ~= " " then
               local name = obj.Name
               local lowerName = name:lower()
               
               -- BROADER filters ‚Äî catches more!
               local isTarget = lowerName:find("bull")     -- Bullseye, Bull...
                          or lowerName:find("target") 
                          or lowerName:find("elite")
                          or lowerName:find("pro")
                          or lowerName:find("advanced")
                          or lowerName:find("basic")
                          or lowerName:find("dummy")
                          or lowerName:find("x") and string.len(name) > 3  -- TargetX but not too short
                          or string.match(name, "%u") and string.match(name, "%d+")  -- Has uppercase + numbers (e.g. Target1)
               
               if isTarget and not seen[name] then
                  table.insert(targetsList, name)
                  seen[name] = true
                  print("‚úÖ Found target: " .. name .. " (in " .. folder:GetFullName() .. ")")
               end
            end
         end
      end
   end
   
   -- Sort & unique
   table.sort(targetsList)
   
   -- Fallback if still empty
   if #targetsList == 0 then
      targetsList = {"Bullseye Elite", "Bullseye Basic", "TargetX", "Basic Target", "Advanced Target"}
      print("‚ùå No targets auto-detected! Using fallbacks. Check console for scan info.")
   end
   
   -- UPDATE DROPDOWN
   TargetDropdown:Refresh(targetsList, true)
   selectedTarget = targetsList[1]
   
   print("üéØ [DEBUG] FINAL: Found " .. #targetsList .. " targets: " .. table.concat(targetsList, ", "))
   print("üìä Scanned " .. totalScanned .. " objects total.")
end

-- Initial scan
refreshTargets()

-- REFRESH BUTTON (hit this after loading/changing area!)
Tab:CreateButton({
   Name = "üîÑ Refresh Targets (Check F9 Console!)",
   Callback = function()
      refreshTargets()
   end,
})

-- BONUS: Manual Textbox for custom target (if auto-detect fails)
local ManualInput = Tab:CreateInput({
   Name = "Custom Target Name",
   PlaceholderText = "e.g. Bullseye Elite",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
      selectedTarget = Text
      Rayfield:Notify({
         Title = "Custom Set",
         Content = "Using: " .. Text,
         Duration = 2,
      })
   end,
})

-- Your Auto Train (uses selectedTarget)
local autoTrain = false
local TrainToggle = Tab:CreateToggle({
   Name = "Auto Train (Dynamic Target)",
   CurrentValue = false,
   Flag = "AutoTrainToggle",
   
   Callback = function(Value)
      autoTrain = Value
      
      if Value then
         task.spawn(function()
            while autoTrain do
               pcall(function()
                  game:GetService("ReplicatedStorage")
                     :WaitForChild("Remotes"):WaitForChild("TrainSpear")
                     :FireServer(selectedTarget)
               end)
               task.wait(0.45)
            end
         end)
         -- Auto-refresh targets every 30s while training
         task.spawn(function()
            while autoTrain do
               task.wait(30)
               refreshTargets()
            end
         end)
      end
   end,
})
