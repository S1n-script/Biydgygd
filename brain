-- Load Rayfield (working link as of 2026)
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Create the main window
local Window = Rayfield:CreateWindow({
    Name = "HM Hub",
    LoadingTitle = "LOADING HM HUB...",
    LoadingSubtitle = "By Tha Hollows",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "HMhub",
        FileName = "Config"
    },
    KeySystem = false,
})

-- Main tab
local MainTab = Window:CreateTab("Main", 4483362458)

-- Variables
local autoClick = false
local autoStat = false
local selectedStat = "Energy"  -- Default

-- =====================================
-- AUTO CLICKER
-- =====================================
local ClickToggle = MainTab:CreateToggle({
    Name = "Auto Clicker",
    CurrentValue = false,
    Flag = "AutoClickToggle",
    
    Callback = function(Value)
        autoClick = Value
        
        if Value then
            Rayfield:Notify({
                Title = "Auto Clicker",
                Content = "Clicking every ~0.03s...",
                Duration = 3
            })
            
            task.spawn(function()
                while autoClick do
                    pcall(function()
                        local clickRemote = game:GetService("ReplicatedStorage")
                            :WaitForChild("Packages")
                            :WaitForChild("_Index")
                            :WaitForChild("sleitnick_knit@1.5.1")
                            :WaitForChild("knit")
                            :WaitForChild("Services")
                            :WaitForChild("ClickService")
                            :WaitForChild("RF")
                            :WaitForChild("Click")
                        
                        clickRemote:InvokeServer()
                    end)
                    
                    task.wait(0.1)  -- Increase to 0.1 if you get kicked
                end
            end)
        end
    end,
})

task.wait(0.5)
local Tab = Window:CreateTab("Misc", 4483362458) -- Title, Image

Tab:CreateToggle({
    Name = "Auto Rank Up",  -- Changed from "Auto Ascension"
    CurrentValue = false,
    Flag = "AutoRankUp",    -- Updated flag name to match (avoids old config conflict)
    
    Callback = function(Value)
        getgenv().AutoRankUp = Value
        
        if Value then
            Rayfield:Notify({
                Title = "Auto Rank Up",
                Content = "Ranking up every 60s...",
                Duration = 4
            })
            
            task.spawn(function()
                while getgenv().AutoRankUp do
                    local success, err = pcall(function()
                        game:GetService("ReplicatedStorage")
                            :WaitForChild("Packages")
                            :WaitForChild("_Index")
                            :WaitForChild("sleitnick_knit@1.5.1")
                            :WaitForChild("knit")
                            :WaitForChild("Services")
                            :WaitForChild("RankupService")
                            :WaitForChild("RF")
                            :WaitForChild("RankUp")
                            :InvokeServer()
                    end)
                    
                    if not success then
                        warn("Auto Rank Up error: " .. tostring(err))
                        Rayfield:Notify({
                            Title = "Auto Rank Up Error",
                            Content = "Failed to rank up â€“ check console. Stopping...",
                            Duration = 6
                        })
                        getgenv().AutoRankUp = false
                        break
                    end
                    
                    task.wait(60)  -- Safe 60-second delay (adjust if needed)
                end
            end)
        else
            Rayfield:Notify({
                Title = "Auto Rank Up",
                Content = "Stopped.",
                Duration = 3
            })
        end
    end,
})

task.wait(0.5)
local Tab = Window:CreateTab("Auto Quest + Farm", 4483362458) -- Title, Image

-- Paste this inside your Tab (e.g. after creating the MainTab or FarmerTab)

local nomekFolder = workspace:WaitForChild("MobSpawns"):WaitForChild("Nomek")

local autoFarmEnabled = false
local farmDelay = 5          -- seconds between TPs (safe value)
local selectedMobType = nil  -- will be set by dropdown

-- Dropdown to pick mob type (unique base names)
local function getMobTypes()
    local types = {}
    local seen = {}
    
    for _, part in ipairs(nomekFolder:GetChildren()) do
        if part:IsA("BasePart") then
            local base = part.Name:gsub("_%d+$", "")
            if base ~= "" and not seen[base] then
                seen[base] = true
                table.insert(types, base)
            end
        end
    end
    
    table.sort(types)
    return #types > 0 and types or {"No mobs found"}
end

local MobDropdown = Tab:CreateDropdown({
    Name = "Select Mob Type to Farm",
    Options = getMobTypes(),
    CurrentOption = {},
    MultipleOptions = false,
    Flag = "FarmMobType",
    
    Callback = function(Option)
        selectedMobType = Option[1]
        if selectedMobType then
            print("Farm target set to:", selectedMobType)
        end
    end,
})

-- Auto Farm Toggle with random TP to any matching mob
local AutoFarmToggle = Tab:CreateToggle({
    Name = "Auto Farm",
    CurrentValue = false,
    Flag = "AutoFarmToggle",
    
    Callback = function(Value)
        autoFarmEnabled = Value
        
        if Value then
            if not selectedMobType then
                Rayfield:Notify({
                    Title = "Error",
                    Content = "Select a mob type first!",
                    Duration = 4
                })
                autoFarmEnabled = false
                AutoFarmToggle:Set(false)
                return
            end
            
            Rayfield:Notify({
                Title = "Auto Farm Started",
                Content = "Teleporting to random " .. selectedMobType .. " every ~" .. farmDelay .. "s",
                Duration = 5
            })
            
            task.spawn(function()
                while autoFarmEnabled do
                    local matches = {}
                    for _, part in ipairs(nomekFolder:GetChildren()) do
                        if part:IsA("BasePart") and part.Name:match("^" .. selectedMobType .. "(_%d+)?$") then
                            table.insert(matches, part)
                        end
                    end
                    
                    if #matches > 0 then
                        local target = matches[math.random(1, #matches)]
                        local offset = CFrame.new(math.random(-4,4), 6, math.random(-6,-3))
                        
                        pcall(function()
                            local char = player.Character
                            if char then
                                char:PivotTo(target.CFrame * offset)
                            end
                        end)
                        
                        print("Teleported to:", target.Name)
                    else
                        print("No " .. selectedMobType .. " found right now")
                    end
                    
                    task.wait(farmDelay)
                end
            end)
        else
            Rayfield:Notify({
                Title = "Auto Farm",
                Content = "Stopped.",
                Duration = 3
            })
        end
    end,
})

-- Delay slider (optional but recommended)
Tab:CreateSlider({
    Name = "TP Delay",
    Range = {1, 15},
    Increment = 0.5,
    Suffix = "s",
    CurrentValue = 5,
    Flag = "FarmDelay",
    Callback = function(Value)
        farmDelay = Value
    end,
})

-- Refresh button for dropdown
Tab:CreateButton({
    Name = "Refresh Mob Types",
    Callback = function()
        local newOptions = getMobTypes()
        MobDropdown:Refresh(newOptions, true)
        Rayfield:Notify({
            Title = "Refreshed",
            Content = #newOptions .. " mob types found",
            Duration = 3
        })
    end,
})
