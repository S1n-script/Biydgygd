-- Load Rayfield (working link as of 2026)
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Improved Stat + Daily Popup Killer Hook with Debug
local mt = getrawmetatable(game)
local oldNamecall = mt.__namecall

local success, err = pcall(function()
    setreadonly(mt, false)
end)

if not success then
    warn("[HOOK DEBUG] setreadonly failed: " .. tostring(err))
    -- Fallback: some executors don't need/want setreadonly
end

mt.__namecall = function(self, ...)
    local method = getnamecallmethod()
    local instanceName = tostring(self)  -- Full path like "ReplicatedStorage.Packages._Index.sleitnick_knit@1.5.1.knit.Services.LevelService.RF.PutStat"
    local args = {...}
    
    -- Debug print EVERY InvokeServer call (remove after testing)
    if method == "InvokeServer" then
        print("[NAMECALL DEBUG] Remote:", instanceName, "Method:", method, "Args:", unpack(args))
    end
    
    local originalResult = oldNamecall(self, ...)
    
    -- DAILIES: Suppress "already claimed" etc.
    if instanceName:find("ClaimReward") and method == "InvokeServer" then
        if typeof(originalResult) == "string" and (
            originalResult:lower():find("already") or 
            originalResult:lower():find("claim") or 
            originalResult:lower():find("claimed") or 
            originalResult:lower():find("unavailable")
        ) then
            print("[HOOK] Blocked daily popup:", originalResult)
            return true  -- Fake success
        end
    end
    
    -- STATS: Suppress "not enough", "max", etc.
    if instanceName:find("PutStat") and method == "InvokeServer" then
        if typeof(originalResult) == "string" and (
            originalResult:lower():find("enough") or 
            originalResult:lower():find("insufficient") or 
            originalResult:lower():find("max") or 
            originalResult:lower():find("can't") or 
            originalResult:lower():find("level") or 
            originalResult:lower():find("upgrade")
        ) then
            print("[HOOK] Blocked stat popup:", originalResult)
            return true  -- Fake success
        end
    end
    
    return originalResult
end

-- Restore readonly if possible
pcall(function()
    setreadonly(mt, true)
end)

print("[HM HUB] Popup hook loaded with debug prints")
-- Create the main window
local Window = Rayfield:CreateWindow({
    Name = "HM Hub",
    LoadingTitle = "Loading HM HUB...",
    LoadingSubtitle = "by Tha Hollows",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "HMhub",
        FileName = "Config"
    },
    KeySystem = false,
})

-- Main tab
local MainTab = Window:CreateTab("Main", 4483362458)

-- Variables
local autoClick = false
local autoStat = false
local selectedStat = "Energy"  -- Default

-- =====================================
-- AUTO CLICKER
-- =====================================
local ClickToggle = MainTab:CreateToggle({
    Name = "Auto Clicker",
    CurrentValue = false,
    Flag = "AutoClickToggle",
    
    Callback = function(Value)
        autoClick = Value
        
        if Value then
            Rayfield:Notify({
                Title = "Auto Clicker",
                Content = "Clicking every ~0.03s...",
                Duration = 3
            })
            
            task.spawn(function()
                while autoClick do
                    pcall(function()
                        local clickRemote = game:GetService("ReplicatedStorage")
                            :WaitForChild("Packages")
                            :WaitForChild("_Index")
                            :WaitForChild("sleitnick_knit@1.5.1")
                            :WaitForChild("knit")
                            :WaitForChild("Services")
                            :WaitForChild("ClickService")
                            :WaitForChild("RF")
                            :WaitForChild("Click")
                        
                        clickRemote:InvokeServer()
                    end)
                    
                    task.wait(0.03)  -- Increase to 0.1 if you get kicked
                end
            end)
        end
    end,
})

-- =====================================
-- AUTO STATS (with Dropdown)
-- =====================================
-- Dropdown to choose stat
local StatDropdown = MainTab:CreateDropdown({
    Name = "Stat Select",
    Options = {"Energy", "Gems", "Luck", "Damage"},  -- Add more if needed
    CurrentOption = {"Energy"},
    Flag = "SelectedStatFlag",
    
    Callback = function(Option)
        selectedStat = Option[1]
        Rayfield:Notify({
            Title = "Stat Updated",
            Content = "Now auto-upgrading: " .. selectedStat,
            Duration = 3
        })
    end,
})

-- Toggle to start auto-upgrade
local StatToggle = MainTab:CreateToggle({
    Name = "Auto Upgrade Selected Stat",
    CurrentValue = false,
    Flag = "AutoStatToggle",
    
    Callback = function(Value)
        autoStat = Value
        
        if Value then
            if not selectedStat then
                Rayfield:Notify({Title = "Error", Content = "Pick a stat first!", Duration = 4})
                autoStat = false
                return
            end
            
            Rayfield:Notify({
                Title = "Auto Stats",
                Content = "Upgrading " .. selectedStat .. " forever...",
                Duration = 4
            })
            
            task.spawn(function()
                local remote = game:GetService("ReplicatedStorage")
                    :WaitForChild("Packages")
                    :WaitForChild("_Index")
                    :WaitForChild("sleitnick_knit@1.5.1")
                    :WaitForChild("knit")
                    :WaitForChild("Services")
                    :WaitForChild("LevelService")
                    :WaitForChild("RF")
                    :WaitForChild("PutStat")
                
                while autoStat do
                    pcall(function()
                        remote:InvokeServer(selectedStat, 1)
                    end)
                    
                    task.wait(0.25)  -- Safe delay – make it 0.4+ if kicked
                end
            end)
        end
    end,
})

-- Loaded notification
Rayfield:Notify({
    Title = "Tha Boo Hub Loaded!",
    Content = "Auto Clicker + Auto Stats ready. Select stat & toggle on!",
    Duration = 5,
    Image = "smile"
})

print("Tha Boo Hub loaded – no auto collect included")

local dailyReward = false

local Toggle = MainTab:CreateToggle({  -- Use 'MainTab' from your full script
    Name = "Auto Claim Daily Rewards (1-9)",
    CurrentValue = false,
    Flag = "DailyRewardToggle",
    
    Callback = function(Value)
        dailyReward = Value
        
        if Value then
            Rayfield:Notify({
                Title = "Daily Rewards",
                Content = "Auto-claiming rewards 1–9 endlessly...",
                Duration = 4
            })
            
            task.spawn(function()
                local remote = game:GetService("ReplicatedStorage")
                    :WaitForChild("Packages")
                    :WaitForChild("_Index")
                    :WaitForChild("sleitnick_knit@1.5.1")
                    :WaitForChild("knit")
                    :WaitForChild("Services")
                    :WaitForChild("GiftService")
                    :WaitForChild("RF")
                    :WaitForChild("ClaimReward")
                
                local rewardIDs = {1, 2, 3, 4, 5, 6, 7, 8, 9}  -- All 1-9 in order
                
                while dailyReward do
                    local success, err = pcall(function()
                        for _, id in ipairs(rewardIDs) do
                            if not dailyReward then break end  -- Stop mid-cycle
                            
                            remote:InvokeServer(id)
                            task.wait(0.2)  -- Delay per reward (anti-spam)
                        end
                    end)
                    
                    if not success then
                        warn("Daily claim error: " .. tostring(err))
                    end
                    
                    task.wait(3)  -- Delay between full cycles (1-9) – prevents kick
                end
            end)
        end
    end,
})

