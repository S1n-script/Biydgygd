local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Rayfield Example Window",
   Icon = 0,
   LoadingTitle = "Rayfield Interface Suite",
   LoadingSubtitle = "by Sirius",
   ShowText = "Rayfield",
   Theme = "Default",

   ToggleUIKeybind = "K",

   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false,

   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "Big Hub"
   },

   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },

   KeySystem = false,
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided",
      FileName = "Key",
      SaveKey = true,
      GrabKeyFromSite = false,
      Key = {"Hello"}
   }
})

local Tab = Window:CreateTab("Tab Example", 4483362458) -- Title, Image

local autoThrow = false

local Toggle = Tab:CreateToggle({
   Name = "AutoThrow",
   CurrentValue = false,
   Flag = "AutoThrowToggle",
   
   Callback = function(Value)
      autoThrow = Value   -- sync with the actual toggle state (true/false)

      if Value then
         -- Run the loop in a separate thread so it doesn't freeze the game
         task.spawn(function()
            while autoThrow do
               local args = {
                  "City"
               }
               
               -- Safe remote firing with timeout + error protection
               pcall(function()
                  game:GetService("ReplicatedStorage")
                     :WaitForChild("Remotes", 8)
                     :WaitForChild("Throw", 5)
                     :FireServer(unpack(args))
               end)
               
               task.wait(0.08)   -- ≈ 12 throws/sec — adjust this:
                                 -- 0.05 = faster   /   0.15 = slower & safer
            end
         end)
      end
      -- When toggle turned OFF → autoThrow = false → loop stops automatically
   end,
})

-- Add this after your Tab is created

local selectedTarget = "Select Target"  -- default / fallback

-- Dropdown to pick target
local TargetDropdown = Tab:CreateDropdown({
   Name = "Select Training Target",
   Options = {"Loading targets..."},  -- placeholder
   CurrentOption = {"Select Target"},  -- default shown
   Flag = "SelectedTargetDropdown",
   
   Callback = function(Option)
      selectedTarget = Option[1]  -- Rayfield dropdown gives table
      Rayfield:Notify({
         Title = "Target Updated",
         Content = "Now training on: " .. selectedTarget,
         Duration = 3,
      })
   end,
})

-- Function to refresh / find all targets
local function refreshTargets()
   local targetsList = {}
   local seen = {}  -- avoid duplicates
   
   -- CHANGE THESE PATHS based on real game structure (use Dex to inspect!)
   local possibleFolders = {
      workspace:FindFirstChild("TrainingArea"),
      workspace:FindFirstChild("Targets"),
      workspace:FindFirstChild("Map"),
      workspace:FindFirstChild("Areas"),
      workspace,  -- fallback: scan whole workspace (slower)
   }
   
   for _, folder in ipairs(possibleFolders) do
      if folder then
         for _, obj in ipairs(folder:GetDescendants()) do
            -- Filter for things that look like targets
            local name = obj.Name
            if (obj:IsA("BasePart") or obj:IsA("Model")) 
               and (name:lower():find("target") 
                    or name:lower():find("bullseye") 
                    or name:lower():find("dummy") 
                    or name:lower():find("elite")) 
               and not seen[name] then
                
               table.insert(targetsList, name)
               seen[name] = true
            end
         end
      end
   end
   
   -- Sort alphabetically
   table.sort(targetsList)
   
   -- If nothing found → fallback
   if #targetsList == 0 then
      targetsList = {"Bullseye Elite", "TargetX", "Basic Target"}  -- add known ones
   end
   
   -- Update dropdown options
   TargetDropdown:Refresh(targetsList, true)  -- true = reset to first option
   
   -- Optional: auto-select first one
   if #targetsList > 0 then
      selectedTarget = targetsList[1]
   end
   
   print("Found " .. #targetsList .. " possible targets!")
end

-- Run once on load + optional refresh button
refreshTargets()

-- Optional: Add a refresh button
Tab:CreateButton({
   Name = "Refresh Target List",
   Callback = function()
      refreshTargets()
      Rayfield:Notify({
         Title = "Refreshed",
         Content = "Scanned for new targets!",
         Duration = 2.5,
      })
   end,
})

-- Example: Your Auto Train toggle using the selected target
local autoTrain = false

local TrainToggle = Tab:CreateToggle({
   Name = "Auto Train (Selected Target)",
   CurrentValue = false,
   Flag = "AutoTrainToggle",
   
   Callback = function(Value)
      autoTrain = Value
      
      if Value then
         task.spawn(function()
            while autoTrain do
               pcall(function()
                  local Remotes = game:GetService("ReplicatedStorage"):WaitForChild("Remotes", 8)
                  local TrainSpear = Remotes:WaitForChild("TrainSpear", 5)
                  
                  TrainSpear:FireServer(selectedTarget)  -- uses whatever is picked
               end)
               
               task.wait(0.45)  -- adjust cooldown/speed
            end
         end)
      end
   end,
})
